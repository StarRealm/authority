{
  "version": 3,
  "sources": ["../src/index.ts"],
  "sourcesContent": ["/** Init */\r\nconst updatePlayerCount = (n: number) => Array.from(document.querySelectorAll('.player'))\r\n  .forEach((player, i) => {\r\n    player.classList.toggle('hidden', i >= n);\r\n    player.setAttribute('aria-hidden', `${i >= n}`);\r\n  });\r\n\r\nconst updateBaseAuthority = (n: number) => Array.from(document.querySelectorAll('.player > .score > span'))\r\n  .forEach(score => {\r\n    score.innerHTML = `${n}`;\r\n  });\r\n\r\nconst update = () => {\r\n  const inputPlayers = document.querySelector<HTMLInputElement>('header select[name=\"players\"]');\r\n  const inputAuthority = document.querySelector<HTMLInputElement>('header input[name=\"authority\"]');\r\n\r\n  updatePlayerCount(inputPlayers?.value ? parseInt(inputPlayers.value, 10) : 2);\r\n  updateBaseAuthority(inputAuthority?.value ? parseInt(inputAuthority?.value, 10) : 50);\r\n};\r\n\r\nconst createContext = async (file: string) => {\r\n  const audioContext = new AudioContext();\r\n  const source = audioContext.createBufferSource();\r\n  const audioBuffer = await fetch(`./assets/${file}`)\r\n    .then(res => res.arrayBuffer())\r\n    .then(buffer => audioContext.decodeAudioData(buffer));\r\n\r\n  source.buffer = audioBuffer;\r\n  source.connect(audioContext.destination);\r\n\r\n  return source;\r\n};\r\n\r\nconst createLifeDown = () => createContext('life_down.wav');\r\nconst createLifeUp = () => createContext('life_up.wav');\r\n\r\nconst debounce = <T extends (...args: any[]) => any>(cb: T, n: number) => {\r\n  let id: ReturnType<typeof setTimeout>;\r\n\r\n  return (...args: Parameters<T>) => new Promise<ReturnType<T>>(resolve => {\r\n    if (id) clearTimeout(id);\r\n    id = setTimeout(() => resolve(cb(...args)), n);\r\n  });\r\n};\r\n\r\n/** Players */\r\nconst init = async () => {\r\n  const speak = (text: string) => speechSynthesis.speak(new SpeechSynthesisUtterance(text));\r\n  const debouncedLifeDown = debounce(async (score: string) => {\r\n    const lifeDown = await createLifeDown();\r\n    lifeDown.start();\r\n    lifeDown.addEventListener('ended', () => {\r\n      lifeDown.stop();\r\n      speak(score);\r\n    });\r\n  }, 1000);\r\n\r\n  const debouncedLifeUp = debounce(async (score: string) => {\r\n    const lifeUp = await createLifeUp();\r\n    lifeUp.start();\r\n    lifeUp.addEventListener('ended', () => {\r\n      lifeUp.stop();\r\n      speak(score);\r\n    });\r\n  }, 1000);\r\n\r\n  Array.from(document.querySelectorAll('.player'))\r\n    .forEach(player => {\r\n      const buttonAdd = player.querySelector<HTMLButtonElement>('button.add');\r\n      const buttonSubtract = player.querySelector<HTMLButtonElement>('button.subtract');\r\n      const score = player.querySelector<HTMLDivElement>('.score > span');\r\n\r\n      buttonAdd?.addEventListener('click', () => {\r\n        if (score) score.innerText = `${parseInt(score.innerText, 10) + 1}`;\r\n        if (score?.innerText) debouncedLifeUp(score.innerText);\r\n      });\r\n\r\n      buttonSubtract?.addEventListener('click', () => {\r\n        if (score) score.innerText = `${parseInt(score.innerText, 10) - 1}`;\r\n        if (score?.innerText) debouncedLifeDown(score.innerText);\r\n      });\r\n    });\r\n};\r\n\r\n/** Reset */\r\ndocument.querySelector('button.reset')?.addEventListener('click', update);\r\n\r\n/** Mirror */\r\ndocument.querySelector('button.mirror')?.addEventListener('click', () => {\r\n  document.querySelector('main')?.classList.toggle('mirror');\r\n});\r\n\r\n/** Show / Hide */\r\ndocument.querySelector('button.focus')?.addEventListener('click', event => {\r\n  document.querySelector('footer')?.classList.toggle('hidden');\r\n  (event.currentTarget as HTMLButtonElement).classList.toggle('show');\r\n  document.querySelector('h1')?.classList.toggle('hidden');\r\n});\r\n\r\ninit();\r\nupdate();\r\n\r\n/** Service Worker */\r\nif ('serviceWorker' in navigator) {\r\n  window.addEventListener('load', () => {\r\n    navigator.serviceWorker\r\n      .register('/star-realms-authority/service.js')\r\n      .catch(console.error);\r\n  });\r\n}\r\n"],
  "mappings": "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",
  "names": ["updatePlayerCount", "n", "player", "i", "updateBaseAuthority", "score", "update", "inputPlayers", "inputAuthority", "createContext", "file", "__async", "audioContext", "source", "audioBuffer", "res", "buffer", "createLifeDown", "createLifeUp", "debounce", "cb", "id", "args", "resolve", "init", "speak", "text", "debouncedLifeDown", "lifeDown", "debouncedLifeUp", "lifeUp", "buttonAdd", "buttonSubtract", "_a", "event", "_b"]
}
