{
  "version": 3,
  "sources": ["../src/index.ts"],
  "sourcesContent": ["/** Init */\r\nconst updatePlayerCount = (n: number) => Array.from(document.querySelectorAll('.player'))\r\n  .forEach((player, i) => {\r\n    player.classList.toggle('hidden', i >= n);\r\n    player.setAttribute('aria-hidden', `${i >= n}`);\r\n  });\r\n\r\nconst updateBaseAuthority = (n: number) => Array.from(document.querySelectorAll('.player > .score > span'))\r\n  .forEach(score => {\r\n    score.innerHTML = `${n}`;\r\n  });\r\n\r\nconst update = () => {\r\n  const inputPlayers = document.querySelector<HTMLInputElement>('header select[name=\"players\"]');\r\n  const inputAuthority = document.querySelector<HTMLInputElement>('header input[name=\"authority\"]');\r\n\r\n  updatePlayerCount(inputPlayers?.value ? parseInt(inputPlayers.value, 10) : 2);\r\n  updateBaseAuthority(inputAuthority?.value ? parseInt(inputAuthority?.value, 10) : 50);\r\n};\r\n\r\nconst createContext = async (file: string) => {\r\n  const audioContext = new AudioContext();\r\n  const source = audioContext.createBufferSource();\r\n  const audioBuffer = await fetch(`./assets/${file}`)\r\n    .then(res => res.arrayBuffer())\r\n    .then(buffer => audioContext.decodeAudioData(buffer));\r\n\r\n  source.buffer = audioBuffer;\r\n  source.connect(audioContext.destination);\r\n\r\n  return source;\r\n};\r\n\r\nconst createLifeDown = () => createContext('life_down.wav');\r\nconst createLifeUp = () => createContext('life_up.wav');\r\n\r\nconst debounce = <T extends (...args: any[]) => any>(cb: T, n: number) => {\r\n  let id: ReturnType<typeof setTimeout>;\r\n\r\n  return (...args: Parameters<T>) => new Promise<ReturnType<T>>(resolve => {\r\n    if (id) clearTimeout(id);\r\n    id = setTimeout(() => resolve(cb(...args)), n);\r\n  });\r\n};\r\n\r\ndocument.querySelector<HTMLButtonElement>('header > button.reset')?.addEventListener('click', update);\r\n\r\n/** Players */\r\nconst init = async () => {\r\n  const speak = (text: string) => speechSynthesis.speak(new SpeechSynthesisUtterance(text));\r\n  const debouncedLifeDown = debounce(async (score: string) => {\r\n    const lifeDown = await createLifeDown();\r\n    lifeDown.start();\r\n    lifeDown.addEventListener('ended', () => {\r\n      lifeDown.stop();\r\n      speak(score);\r\n    });\r\n  }, 1000);\r\n\r\n  const debouncedLifeUp = debounce(async (score: string) => {\r\n    const lifeUp = await createLifeUp();\r\n    lifeUp.start();\r\n    lifeUp.addEventListener('ended', () => {\r\n      lifeUp.stop();\r\n      speak(score);\r\n    });\r\n  }, 1000);\r\n\r\n  Array.from(document.querySelectorAll('.player'))\r\n    .forEach(player => {\r\n      const buttonAdd = player.querySelector<HTMLButtonElement>('button.add');\r\n      const buttonSubtract = player.querySelector<HTMLButtonElement>('button.subtract');\r\n      const score = player.querySelector<HTMLDivElement>('.score > span');\r\n\r\n      buttonAdd?.addEventListener('click', () => {\r\n        if (score) score.innerText = `${parseInt(score.innerText, 10) + 1}`;\r\n        if (score?.innerText) debouncedLifeUp(score.innerText);\r\n      });\r\n\r\n      buttonSubtract?.addEventListener('click', () => {\r\n        if (score) score.innerText = `${parseInt(score.innerText, 10) - 1}`;\r\n        if (score?.innerText) debouncedLifeDown(score.innerText);\r\n      });\r\n    });\r\n}\r\n\r\ninit();\r\nupdate();\r\n\r\n/** Service Worker */\r\nif ('serviceWorker' in navigator) {\r\n  window.addEventListener('load', () => {\r\n    navigator.serviceWorker\r\n      .register('/star-realms-authority/service.js')\r\n      .catch(console.error);\r\n  });\r\n}\r\n"],
  "mappings": "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",
  "names": ["updatePlayerCount", "player", "i", "updateBaseAuthority", "score", "update", "inputPlayers", "inputAuthority", "createContext", "file", "__async", "audioContext", "source", "audioBuffer", "res", "buffer", "createLifeDown", "createLifeUp", "debounce", "cb", "n", "id", "args", "resolve", "_a", "init", "speak", "text", "debouncedLifeDown", "lifeDown", "debouncedLifeUp", "lifeUp", "buttonAdd", "buttonSubtract"]
}
